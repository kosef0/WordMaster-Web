{% extends 'base.html' %}
{% load static %}

{% block title %}Flashcards - WordMaster{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/animations.css' %}">
<link rel="stylesheet" href="{% static 'css/modern-flashcards.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}

{% block content %}
<div class="flashcards-container">
    <div class="flashcards-header">
        <h2 class="slideInDown"><i class="fas fa-layer-group"></i> Kelime Kartları</h2>
        <p class="slideInRight delay-200">Kelimeleri tekrar etmek için kartları çevirin ve öğrenme durumunuzu takip edin.</p>
    </div>
    
    <div class="flashcards-controls fadeIn delay-300">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Kelime ara...">
        </div>
        
        <div class="filter-options">
            <select id="categoryFilter" class="fadeIn delay-400">
                <option value="">Tüm Kategoriler</option>
                {% for category in categories %}
                    <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>
            
            <select id="difficultyFilter" class="fadeIn delay-500">
                <option value="">Tüm Zorluklar</option>
                <option value="easy">Kolay</option>
                <option value="medium">Orta</option>
                <option value="hard">Zor</option>
            </select>
        </div>
        
        <div class="flashcards-navigation fadeIn delay-600">
            <button id="prevCard" class="btn btn-secondary animated-button" disabled><i class="fas fa-chevron-left"></i> Önceki</button>
            <span id="cardCounter" class="card-counter">1 / 10</span>
            <button id="nextCard" class="btn btn-primary animated-button">Sonraki <i class="fas fa-chevron-right"></i></button>
        </div>
    </div>
    
    <div class="flashcards-grid">
        {% for word in words %}
            <div class="flashcard fadeIn delay-{{ forloop.counter|add:"200" }} {% if forloop.first %}active{% endif %}" data-category="{% for cat in word.categories %}{{ cat.id }} {% endfor %}" data-difficulty="{{ word.difficulty }}" data-word-id="{{ word.id }}">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <div class="flashcard-word">{{ word.english }}</div>
                        <div class="flashcard-phonetic">{{ word.phonetic|default:"" }}</div>
                        <div class="flashcard-hint"><i class="fas fa-sync"></i> Çevirmek için tıkla</div>
                    </div>
                    <div class="flashcard-back">
                        <div class="flashcard-word">{{ word.turkish }}</div>
                        <div class="flashcard-part">{{ word.part_of_speech }}</div>
                        <div class="flashcard-example">{{ word.example_sentence }}</div>
                        <div class="flashcard-actions">
                            <button class="mark-known" title="Biliyorum"><i class="fas fa-check"></i></button>
                            <button class="mark-review" title="Tekrar Et"><i class="fas fa-redo"></i></button>
                        </div>
                    </div>
                </div>
                <div class="flashcard-progress" {% if word.progress %}style="width: {{ word.progress }}%;"{% else %}style="width: 0%;"{% endif %}></div>
            </div>
        {% endfor %}
        
        {% if not words %}
        <div class="empty-state fadeIn">
            <i class="fas fa-book"></i>
            <h3>Henüz kelime kartı bulunmuyor</h3>
            <p>Kelime ekleyerek çalışmaya başlayabilirsiniz.</p>
            <a href="{% url 'add_word' %}" class="btn btn-primary"><i class="fas fa-plus"></i> Kelime Ekle</a>
        </div>
        {% endif %}
    </div>
    
    <div class="flashcards-actions fadeIn delay-700">
        <button id="markLearned" class="btn btn-primary animated-button"><i class="fas fa-check-circle"></i> Öğrendim</button>
        <button id="markReview" class="btn btn-secondary animated-button"><i class="fas fa-sync-alt"></i> Tekrar Et</button>
        <button id="resetCards" class="btn btn-outline animated-button"><i class="fas fa-undo"></i> Sıfırla</button>
    </div>
    
    <div class="pagination fadeIn delay-800">
        <button class="page-btn" data-page="1">1</button>
        <button class="page-btn" data-page="2">2</button>
        <button class="page-btn" data-page="3">3</button>
        <button class="page-btn more">...</button>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/flashcards.js' %}"></script>
            if (currentCardIndex < visibleCards.length - 1) {
                currentCard.classList.remove('active');
                currentCardIndex++;
                visibleCards[currentCardIndex].classList.add('active');
                updateCardCounter();
            }
        });
        
        markReviewButton.addEventListener('click', function() {
            if (visibleCards.length === 0) return;
            
            const currentCard = visibleCards[currentCardIndex];
            const wordId = currentCard.dataset.wordId;
            
            // In a real app, this would be an API call
            console.log('Marked for review:', wordId);
            
            // Move to next card if available
            if (currentCardIndex < visibleCards.length - 1) {
                currentCard.classList.remove('active');
                currentCardIndex++;
                visibleCards[currentCardIndex].classList.add('active');
                updateCardCounter();
            }
        });
    });
</script>
{% endblock %}